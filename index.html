<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laptop Disconnect Tracker</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide React icons as inline SVGs
        const AlertCircle = ({ className, size = 24 }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
        );

        const Zap = ({ className, size = 24 }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
            </svg>
        );

        const DollarSign = ({ className, size = 24 }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
            </svg>
        );

        const Calendar = ({ className, size = 24 }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
        );

        const Clock = ({ className, size = 24 }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
        );

        const Laptop = ({ className, size = 24 }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect>
                <line x1="8" y1="21" x2="16" y2="21"></line>
                <line x1="12" y1="17" x2="12" y2="21"></line>
            </svg>
        );

        const LaptopDisconnectTracker = () => {
            const [disconnects, setDisconnects] = useState([]);
            const [loading, setLoading] = useState(true);
            const [justLogged, setJustLogged] = useState(false);

            const HOURLY_RATE = 28.85;
            const MINUTES_PER_DISCONNECT = 1.5;
            const DOCK_COST = 200;
            const MACBOOK_COST = 1999;
            const START_DATE = new Date('2025-11-10');
            
            // JSONBin configuration
            const JSONBIN_BIN_ID = '693c6401ae596e708f95a275';
            const JSONBIN_API_KEY = '$2a$10$/YLBcUygF5hArW5BnYfeUOsP9rcjOyfzgC..DZXHJReYgIAH7J8ra';
            const JSONBIN_URL = `https://api.jsonbin.io/v3/b/${JSONBIN_BIN_ID}`;

            const EXCLUDED_DATES = [
                '2025-11-27',
                '2025-11-28',
                '2025-11-29',
            ];

            useEffect(() => {
                loadData();
            }, []);

            const isWorkday = (date) => {
                const day = date.getDay();
                const dateStr = date.toISOString().split('T')[0];
                return day !== 0 && day !== 6 && !EXCLUDED_DATES.includes(dateStr);
            };

            const loadData = async () => {
                try {
                    const response = await fetch(JSONBIN_URL + '/latest', {
                        method: 'GET',
                        headers: {
                            'X-Master-Key': JSONBIN_API_KEY
                        }
                    });
                    
                    if (response.ok) {
                        const data = await response.json();
                        setDisconnects(data.record || []);
                    } else {
                        console.error('API Error:', response.status);
                    }
                } catch (error) {
                    console.error('Fetch error:', error);
                }
                setLoading(false);
            };

            const logDisconnect = async () => {
                const now = new Date();
                const newDisconnect = {
                    timestamp: now.toISOString(),
                    date: now.toISOString().split('T')[0],
                };
                
                const updated = [...disconnects, newDisconnect];
                setDisconnects(updated);
                
                try {
                    const response = await fetch(JSONBIN_URL, {
                        method: 'PUT',
                        headers: {
                            'Content-Type': 'application/json',
                            'X-Master-Key': JSONBIN_API_KEY
                        },
                        body: JSON.stringify(updated)
                    });
                    
                    if (response.ok) {
                        setJustLogged(true);
                        setTimeout(() => setJustLogged(false), 2000);
                    } else {
                        console.error('Failed to save:', response.statusText);
                    }
                } catch (error) {
                    console.error('Failed to save:', error);
                }
            };

            const getAllDisconnects = () => {
                return [...disconnects];
            };

            const getStats = () => {
                const allDisconnects = getAllDisconnects();
                const now = new Date();
                
                const totalMinutesWasted = allDisconnects.length * MINUTES_PER_DISCONNECT;
                const totalHoursWasted = totalMinutesWasted / 60;
                const totalSalaryWasted = totalHoursWasted * HOURLY_RATE;
                
                const docksAfforded = totalSalaryWasted / DOCK_COST;
                const laptopsAfforded = totalSalaryWasted / MACBOOK_COST;
                
                const sortedDisconnects = [...disconnects].sort((a, b) => 
                    new Date(b.timestamp) - new Date(a.timestamp)
                );
                const lastDisconnect = sortedDisconnects[0] 
                    ? new Date(sortedDisconnects[0].timestamp)
                    : null;
                
                const daysSinceDisconnect = lastDisconnect 
                    ? Math.floor((now - lastDisconnect) / (1000 * 60 * 60 * 24))
                    : 0;
                
                return {
                    totalDisconnects: allDisconnects.length,
                    totalMinutesWasted: Math.round(totalMinutesWasted),
                    totalHoursWasted: totalHoursWasted.toFixed(1),
                    totalSalaryWasted: totalSalaryWasted.toFixed(2),
                    docksAfforded: docksAfforded.toFixed(2),
                    laptopsAfforded: laptopsAfforded.toFixed(2),
                    daysSinceDisconnect
                };
            };

            const getProgressColor = (value) => {
                if (value >= 1) return 'bg-green-500';
                if (value >= 0.5) return 'bg-yellow-500';
                return 'bg-red-500';
            };

            if (loading) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 flex items-center justify-center">
                        <div className="text-white text-xl">Loading disconnect data...</div>
                    </div>
                );
            }

            const stats = getStats();

            return (
                <div className="min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 p-8">
                    <div className="max-w-6xl mx-auto">
                        <div className="text-center mb-8">
                            <h1 className="text-5xl font-bold text-white mb-2 flex items-center justify-center gap-3">
                                <Zap className="text-yellow-400" size={48} />
                                The Laptop Disconnect Chronicles
                                <Zap className="text-yellow-400" size={48} />
                            </h1>
                            <p className="text-gray-400 text-lg">A data-driven case for new equipment</p>
                        </div>

                        <div className="flex justify-center mb-8">
                            <button
                                onClick={logDisconnect}
                                className={`px-8 py-4 rounded-lg font-bold text-lg transition-all transform hover:scale-105 ${
                                    justLogged 
                                        ? 'bg-green-600 text-white' 
                                        : 'bg-red-600 hover:bg-red-700 text-white'
                                }`}
                            >
                                {justLogged ? '✓ Logged!' : '⚡ Log Disconnect'}
                            </button>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                            <div className="bg-gray-800 rounded-lg p-6 border border-gray-700">
                                <div className="flex items-center gap-3 mb-4">
                                    <Calendar className="text-blue-400" size={32} />
                                    <h3 className="text-xl font-bold text-white">Days Without Incident</h3>
                                </div>
                                <div className="text-5xl font-bold text-blue-400">
                                    {stats.daysSinceDisconnect}
                                </div>
                                <p className="text-gray-400 mt-2">Consecutive days of peace</p>
                            </div>

                            <div className="bg-gray-800 rounded-lg p-6 border border-gray-700">
                                <div className="flex items-center gap-3 mb-4">
                                    <Zap className="text-red-400" size={32} />
                                    <h3 className="text-xl font-bold text-white">All Time Total</h3>
                                </div>
                                <div className="text-5xl font-bold text-red-400">
                                    {stats.totalDisconnects}
                                </div>
                                <p className="text-gray-400 mt-2">Total incidents logged</p>
                            </div>
                        </div>

                        <div className="mb-8">
                            <div className="bg-gray-800 rounded-lg p-6 border border-gray-700">
                                <div className="flex items-center gap-3 mb-4">
                                    <Clock className="text-purple-400" size={32} />
                                    <h3 className="text-xl font-bold text-white">Time Wasted (All Time)</h3>
                                </div>
                                <div className="text-4xl font-bold text-purple-400">
                                    {stats.totalHoursWasted} hours
                                </div>
                                <p className="text-gray-400 mt-2">{stats.totalMinutesWasted} minutes of productivity lost</p>
                            </div>
                        </div>

                        <div className="bg-gradient-to-r from-green-900 to-emerald-900 rounded-lg p-8 border-2 border-green-500 mb-8">
                            <div className="flex items-center gap-3 mb-6">
                                <DollarSign className="text-green-400" size={40} />
                                <h2 className="text-3xl font-bold text-white">The Bottom Line</h2>
                            </div>
                            
                            <div>
                                <p className="text-gray-300 text-lg mb-2">Total Salary Wasted</p>
                                <div className="text-5xl font-bold text-green-400">
                                    ${stats.totalSalaryWasted}
                                </div>
                            </div>
                        </div>

                        <div className="bg-gray-800 rounded-lg p-8 border border-gray-700">
                            <div className="flex items-center gap-3 mb-6">
                                <Laptop className="text-cyan-400" size={40} />
                                <h2 className="text-3xl font-bold text-white">What We Could Have Bought Instead</h2>
                            </div>
                            
                            <div className="space-y-6">
                                <div>
                                    <div className="flex justify-between items-center mb-2">
                                        <span className="text-xl text-gray-300">USB-C Docking Stations ($200 each)</span>
                                        <span className="text-2xl font-bold text-white">{(parseFloat(stats.docksAfforded) * 100).toFixed(0)}%</span>
                                    </div>
                                    <div className="w-full bg-gray-700 rounded-full h-6 overflow-hidden">
                                        <div 
                                            className={`h-full ${getProgressColor(parseFloat(stats.docksAfforded))} transition-all duration-500 flex items-center justify-center text-white text-sm font-bold`}
                                            style={{ width: `${Math.min(parseFloat(stats.docksAfforded) * 100, 100)}%` }}
                                        >
                                            {parseFloat(stats.docksAfforded) >= 0.1 && `${(parseFloat(stats.docksAfforded) * 100).toFixed(0)}%`}
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <div className="flex justify-between items-center mb-2">
                                        <span className="text-xl text-gray-300">MacBook Pros ($1,999 each)</span>
                                        <span className="text-2xl font-bold text-white">{(parseFloat(stats.laptopsAfforded) * 100).toFixed(0)}%</span>
                                    </div>
                                    <div className="w-full bg-gray-700 rounded-full h-6 overflow-hidden">
                                        <div 
                                            className={`h-full ${getProgressColor(parseFloat(stats.laptopsAfforded))} transition-all duration-500 flex items-center justify-center text-white text-sm font-bold`}
                                            style={{ width: `${Math.min(parseFloat(stats.laptopsAfforded) * 100, 100)}%` }}
                                        >
                                            {parseFloat(stats.laptopsAfforded) >= 0.1 && `${(parseFloat(stats.laptopsAfforded) * 100).toFixed(0)}%`}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div className="mt-8 p-4 bg-gray-900 rounded-lg border border-yellow-500">
                                <p className="text-yellow-400 text-center text-lg font-semibold">
                                    "Let the light guide your way" - Wiz Khalifa
                                </p>
                            </div>
                        </div>

                        <div className="mt-8 text-center text-gray-500 text-sm">
                            <p>Data tracked since November 10, 2025</p>
                            <p className="mt-1">Each disconnect assumes 1.5 minutes of lost productivity</p>
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<LaptopDisconnectTracker />, document.getElementById('root'));
    </script>
</body>
</html>
